// Generated by CoffeeScript 1.10.0
angular.module('indexController', ['ngMaterial', 'WPAPI', 'ngSanitize']).controller('IndexCtrl', [
  '$scope', '$mdMedia', '$routeParams', '$location', '$httpParamSerializer', 'PostService', 'TagService', 'CategoryService', function($scope, $mdMedia, $routeParams, $location, $httpParamSerializer, PostService, TagService, CategoryService) {
    var getPageLink, getTotalpages, refreshView;
    getTotalpages = function(data, header) {
      $scope.totalPage = header()['x-wp-totalpages'];
      return getPageLink();
    };
    getPageLink = function() {
      var first_params, last_params, next_params, params, path, prev_params;
      params = $location.search();
      first_params = JSON.parse(JSON.stringify(params));
      first_params['page'] = 1;
      prev_params = JSON.parse(JSON.stringify(params));
      prev_params['page'] = $scope.currentPage - 1;
      next_params = JSON.parse(JSON.stringify(params));
      next_params['page'] = $scope.currentPage + 1;
      last_params = JSON.parse(JSON.stringify(params));
      last_params['page'] = $scope.totalPage;
      path = $location.path();
      return $scope.pageLink = {
        first: ['.', path, '?', $httpParamSerializer(first_params)].join(''),
        prev: ['.', path, '?', $httpParamSerializer(prev_params)].join(''),
        next: ['.', path, '?', $httpParamSerializer(next_params)].join(''),
        last: ['.', path, '?', $httpParamSerializer(last_params)].join('')
      };
    };
    refreshView = function() {
      var params, tax;
      $scope.currentPage = $routeParams.page ? parseInt($routeParams.page) : 1;
      tax = $location.path().slice(0, 9);
      switch (tax) {
        case '/':
          return $scope.posts = PostService.query({
            page: $scope.currentPage
          }, getTotalpages);
        case '/post/tag':
          return $scope.posts = PostService.query(params, getTotalpages);
        case '/post/cat':
          params = JSON.parse('{"page": "' + $scope.currentPage + '", "filter\[category_name\]": "' + $routeParams.slug + '"}');
          return $scope.posts = PostService.query(params, getTotalpages);
      }
    };
    refreshView();
    $scope.cats = CategoryService.queryObject();
    $scope.tags = TagService.queryObject();
    $scope.$mdMedia = $mdMedia;
  }
]);

//# sourceMappingURL=indexController.js.map
